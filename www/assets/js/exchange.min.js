const Exchange={formatter:{Name:(cellValue,_options,rowObject)=>{const classOn=rowObject.Checked?"btn--star--on":"btn--star";return`<button type="button" class="btn ${classOn}"></button>${cellValue}`},CurrentPrice:(cellValue,_options,rowObject)=>"undefined"!=typeof Intl?rowObject.Difference>=0?'<span class="text-red text-bold">'+new Intl.NumberFormat("ko-KR").format(cellValue)+"</span>":'<span class="text-blue text-bold">'+new Intl.NumberFormat("ko-KR").format(cellValue)+"</span>":'<span class="text-red text-bold">'+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+"</span>",TransactionPrice:(cellValue,_options,rowObject)=>"undefined"!=typeof Intl?cellValue>=1e6&&cellValue%1e6==0?cellValue=cellValue/1e6+"백만":new Intl.NumberFormat("ko-KR").format(cellValue):cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),Difference:(cellValue,_options,_rowObject)=>{if("undefined"!=typeof Intl){const nf=new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2});return cellValue>=0?'<span class="text-red text-bold">+'+nf.format(cellValue)+"%</span>":'<span class="text-blue text-bold">'+nf.format(cellValue)+"%</span>"}return cellValue>=0?'<span class="text-red">'+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+"%</span>":'<span class="text-blue">'+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")+"%</span>"},Price:(cellValue,_options,_rowObject)=>"undefined"!=typeof Intl?"$"+new Intl.NumberFormat("ko-KR",{minimumFractionDigits:1}).format(cellValue):"$"+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),TotalPrice:(cellValue,_options,_rowObject)=>"undefined"!=typeof Intl?"$"+new Intl.NumberFormat("ko-KR",{minimumFractionDigits:1}).format(cellValue):"$"+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")}};$((function(){const sidePanelWidth=$(".side--panel").width(),detailsWidth=$("main").width()-sidePanelWidth-20;console.log(detailsWidth),$("#jqGrid").jqGrid({url:"data.json",datatype:"json",colModel:[{label:"이름",name:"Name",width:160,formatter:Exchange.formatter.Name,resizable:!1},{label:"타입",name:"Type",width:64,align:"center",resizable:!1},{label:"생산연도",name:"Year",width:76,align:"center",sorttype:"number",resizable:!1},{label:"현재가",name:"CurrentPrice",width:84,sorttype:"number",align:"right",formatter:Exchange.formatter.CurrentPrice,resizable:!1},{label:"전일대비",name:"Difference",width:76,sorttype:"integer",align:"right",formatter:Exchange.formatter.Difference,resizable:!1},{label:"거래대금",name:"TransactionPrice",width:105,sorttype:"integer",align:"right",formatter:Exchange.formatter.TransactionPrice,resizable:!1},{name:"Checked",hidden:!0}],loadonce:!0,width:sidePanelWidth,height:971,rowNum:20,viewrecords:!0}),$("#detailsGrid").jqGrid({url:"data2.json",datatype:"json",colModel:[{label:"번호",name:"Num",width:99*detailsWidth/834,align:"center",resizable:!1},{label:"구분",name:"Category",width:96*detailsWidth/834,align:"center",resizable:!1},{label:"등록일",name:"CreatedAt",width:68*detailsWidth/834,align:"center",formatter:"date",formatoptions:{srcformat:"Y/m/d",newformat:"Y/m/d"},resizable:!1},{label:"가격",name:"Price",width:92*detailsWidth/834,formatter:Exchange.Price,align:"right",sorttype:"number",resizable:!1},{label:"수량",name:"Quantity",width:123*detailsWidth/834,sorttype:"number",align:"center",resizable:!1},{label:"총액",name:"TotalPrice",width:92*detailsWidth/834,sorttype:"integer",align:"right",formatter:Exchange.TotalPrice,resizable:!1},{label:"상태",name:"Status",width:148*detailsWidth/834,align:"center",resizable:!1},{label:"거래버튼",width:70*detailsWidth/834,formatter:_cellValue=>'<button type="button" class="btn btn--blue btn--rounded" data-toggle="modal" data-target="#modal-sell" style="width: 100%; height: 25px; line-height: 25px">판매</button>'}],loadonce:!0,width:detailsWidth,height:352,rowNum:20,viewrecords:!0,shrinkToFit:!1}),$("#detailsGrid2").jqGrid({url:"data2.json",datatype:"json",rownumbers:!1,colModel:[{label:"번호",name:"Num",width:99*detailsWidth/834,align:"center",resizable:!1},{label:"구분",name:"Category",width:96*detailsWidth/834,align:"center",resizable:!1},{label:"등록일",name:"CreatedAt",width:68*detailsWidth/834,align:"center",formatter:"date",formatoptions:{srcformat:"Y/m/d",newformat:"Y/m/d"},resizable:!1},{label:"가격",name:"Price",width:92*detailsWidth/834,formatter:Exchange.formatter.Price,align:"right",sorttype:"number",resizable:!1},{label:"수량",name:"Quantity",width:123*detailsWidth/834,sorttype:"number",align:"center",resizable:!1},{label:"총액",name:"TotalPrice",width:92*detailsWidth/834,sorttype:"integer",align:"right",formatter:cellValue=>"undefined"!=typeof Intl?"$"+new Intl.NumberFormat("ko-KR",{minimumFractionDigits:1}).format(cellValue):"$"+cellValue.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,","),resizable:!1},{label:"상태",name:"Status",width:148*detailsWidth/834,align:"center",resizable:!1},{label:"거래버튼",width:70*detailsWidth/834,formatter:_cellValue=>'<button type="button" class="btn btn--red btn--rounded" data-toggle="modal" data-target="#modal-buy" style="width: 100%; height: 25px; line-height: 25px">구매</button>'}],loadonce:!0,width:detailsWidth,height:308,rowNum:20,viewrecords:!0,shrinkToFit:!1}),$("#modal-buy").submit(()=>($("#alert-buy").addClass("modal--open"),!1))}));const getData=async()=>{const res=await fetch("data.csv"),resp=await res.text(),cdata=resp.split("\n").map(row=>{const[time1,time2,open,high,low,close,volume]=row.split(",");return{time:new Date(`${time1}, ${time2}`).getTime()/1e3,open:1*open,high:1*high,low:1*low,close:1*close,volume:1*volume}});return cdata},genVolumeData=data=>{let previous_close=0;const rdata=data.map(row=>{console.log(row);const price_decrease_color="rgba(255,82,82, 0.8)",price_increase_color="rgba(0, 150, 136, 0.8)",price_color=previous_close<=row.close?price_increase_color:price_decrease_color;return previous_close=row.close,{time:row.time,value:1*row.volume,color:price_color}});return rdata};var height=300;const sidePanelWidth=$(".side--panel").width(),detailsWidth=$("main").width()-sidePanelWidth-20,container=document.getElementById("tvchart"),chart=LightweightCharts.createChart(container,{width:detailsWidth,height:height,crosshair:{mode:LightweightCharts.CrosshairMode.Normal}});var candleSeries=chart.addCandlestickSeries(),volumeSeries=chart.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"",scaleMargins:{top:.8,bottom:0}});const displayChart=async(data,period="1d")=>{function addSMAtoChart(data,cnt,color,line_width){var smaData=calculateSMA(data,cnt),smaLine;chart.addLineSeries({color:color||"rgba(4, 111, 232, 1)",lineWidth:line_width||1}).setData(smaData)}function calculateSMA(data,count){for(var avg=function(data){for(var sum=0,i=0;i<data.length;i++)sum+=data[i].close;return sum/data.length},result=[],i=count-1,len=data.length;i<len;i++){var val=avg(data.slice(i-count+1,i));result.push({time:data[i].time,value:val})}return result}function fillBarsSegment(left,right,points){for(var deltaY,deltaX,angle=(right.price-left.price)/(right.index-left.index),i=left.index;i<=right.index;i++){var basePrice=left.price+(i-left.index)*angle,openNoise,closeNoise,open=basePrice*(.1-.2*Math.random()+1),close=basePrice*(.1-.2*Math.random()+1),high=Math.max(basePrice*(1+.2*Math.random()),open,close),low=Math.min(basePrice*(1-.2*Math.random()),open,close);points[i].open=open,points[i].high=high,points[i].low=low,points[i].close=close}}function generateControlPoints(res,period,dataMultiplier){var time=void 0!==period?period.timeFrom:{day:1,month:1,year:2018},timeTo,days=getDiffDays(time,void 0!==period?period.timeTo:{day:1,month:1,year:2019});dataMultiplier=dataMultiplier||1;var controlPoints=[];controlPoints.push({index:0,price:getRandomPrice()*dataMultiplier});for(var i=0;i<days;i++)i>0&&i<days-1&&Math.random()<.05&&controlPoints.push({index:i,price:getRandomPrice()*dataMultiplier}),res.push({time:time}),time=nextBusinessDay(time);return controlPoints.push({index:res.length-1,price:getRandomPrice()*dataMultiplier}),controlPoints}function getDiffDays(dateFrom,dateTo){var df=convertBusinessDayToUTCTimestamp(dateFrom),dt=convertBusinessDayToUTCTimestamp(dateTo),diffTime=Math.abs(dt.getTime()-df.getTime());return Math.ceil(diffTime/864e5)}function convertBusinessDayToUTCTimestamp(date){return new Date(Date.UTC(date.year,date.month-1,date.day,0,0,0,0))}function nextBusinessDay(time){var d=convertBusinessDayToUTCTimestamp({year:time.year,month:time.month,day:time.day+1});return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate()}}function getRandomPrice(){return 10+Math.round(1e4*Math.random())/100}candleSeries.setData(data),volumeSeries.setData(genVolumeData(data)),addSMAtoChart(data,10,"#F00"),addSMAtoChart(data,30,"#0F0"),addSMAtoChart(data,90,"#00F")};API.getChartData("btc",resp=>{displayChart(resp)}),$(".tab--sell").click(e=>{API.getTradingList(()=>{})});
//# sourceMappingURL=exchange.min.js.map