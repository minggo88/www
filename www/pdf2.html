<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PDF Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="전체화면 앱">
  <meta name="theme-color" content="#222">
  <meta name="screen-orientation" content="portrait">
  <link rel="icon" href="../assets/img/ReadBook/2.1.4/favicon.ico">
  <link rel="apple-touch-icon" href="../assets/img/ReadBook/2.1.4/favicon.ico">
  <style>
    /* 기본 스타일 */
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      min-width: 100vw;
      overflow: hidden;
      font-family: 'Noto Sans KR', '맑은 고딕', 'Malgun Gothic', Arial, sans-serif;
      background: transparent;
      position: fixed;
    }
    
    body {
      background: transparent;
      width: 100vw;
      height: 100vh;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-appearance: none;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    
    #app {
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* 탭바 스타일 */
    #tabbar-modal-overlay {
      display: none;
      position: fixed;
      left: 0; top: 0; right: 0; bottom: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.35);
      z-index: 9998;
    }
    
    #tabbar-container {
      width: auto;
      min-width: 340px;
      max-width: 90vw;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.18);
      z-index: 9999;
      padding: 32px 32px 18px 32px;
    }
    
    #tabbar-container.show-tabbar {
      display: flex;
    }
    
    #tabbar-container.show-tabbar ~ #tabbar-modal-overlay {
      display: block;
    }
    
    #tabbar {
      display: flex;
      gap: 8px;
      margin: 0 0 18px 0;
    }
    
    .tab {
      background: #f2f2f2;
      border: 1px solid #ccc;
      border-radius: 8px 8px 0 0;
      padding: 12px 48px;
      min-width: 160px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    
    .tab.active {
      background: #222;
      color: #fff;
      border-bottom: 2px solid #222;
    }
    
    #searchbox {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    #searchInput {
      padding: 8px 14px;
      font-size: 1rem;
      border: 1px solid #bbb;
      border-radius: 6px;
      outline: none;
    }
    
    #searchBtn {
      padding: 8px 18px;
      font-size: 1rem;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    #searchBtn:hover {
      background: #444;
    }
    
    /* 슬라이드 컨테이너 */
    .slide-container {
      width: 100vw;
      height: 100vh;
      max-width: 100vw;
      max-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      pointer-events: auto;
      overflow: hidden;
    }
    
    .slide {
      width: 100vw;
      height: 100vh;
      max-width: 100vw;
      max-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
      pointer-events: auto;
    }
    
    .slide-img-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .slide-bg {
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
      display: block;
    }
    
    /* PDF 이미지 크기 통일 스타일 */
    .slide-bg[src*="pdf2"] {
      object-fit: contain !important;
      max-width: 100% !important;
      max-height: 100vh !important;
      width: auto !important;
      height: auto !important;
      background-color: transparent !important;
      border-radius: 8px !important;
      box-shadow: none !important;
      padding: 15px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    

    
    /* PDF2 이미지 내부 컨테이너 */
    .slide[style*="pdf2"] .slide-img-wrapper {
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      width: 100% !important;
      height: 100% !important;
      background-color: transparent !important;
      border-radius: 8px !important;
      box-shadow: none !important;
      margin: 0 auto !important;
      max-width: 100% !important;
      max-height: 100vh !important;
    }
    
    /* 텍스트 존 스타일 */
    .text-zone {
      position: absolute;
      color: white;
      font-family: Arial, sans-serif;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      line-height: 1.4;
      z-index: 10;
      word-wrap: break-word;
      padding: 0;
      margin: 0;
      box-sizing: border-box;
      background: transparent;
      border-radius: 0;
      backdrop-filter: none;
      transition: all 0.3s ease;
    }
    
    .text-zone p {
      color: #222;
      font-family: 'Noto Sans KR', '맑은 고딕', 'Malgun Gothic', Arial, sans-serif;
      font-weight: 600;
      font-size: 35px;
      line-height: 1.3;
      letter-spacing: -0.05em;
      text-shadow:
        1px 1px 0 #fff,
        -1px 1px 0 #fff,
        1px -1px 0 #fff,
        -1px -1px 0 #fff,
        0.5px 0.5px 1px rgba(0,0,0,0.1) !important;
      filter: none !important;
      max-width: none;
      width: auto;
      z-index: 50;
      pointer-events: auto;
      text-align: left;
      word-break: break-word;
      hyphens: auto;
      margin: 0;
      padding: 0;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.4s cubic-bezier(0.4,0,0.2,1), transform 0.4s cubic-bezier(0.4,0,0.2,1);
    }
    
    .text-zone p.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .text-zone p.done {
      opacity: 1;
      transform: translateY(0);
      transition: none;
    }
    
    /* 명사 버튼 스타일 */
    .noun-span {
      cursor: pointer;
      pointer-events: auto;
      color: #222;
      background: transparent !important;
      border: none;
      padding: 0;
      margin: 0;
      font: inherit;
      text-decoration: none;
      transition: background-color 0.2s ease;
    }
    
    .noun-span:hover {
      background-color: transparent !important;
    }
    
    .noun-span:active {
      background-color: transparent !important;
    }
    
    /* 기존 버튼을 항상 보이도록 수정 */
    .nav-button {
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* 기존 hover 효과 제거 */
    .nav-button:hover {
      opacity: 1 !important;
    }
    
    /* 4zone.css의 hover 기반 표시를 무시하고 항상 보이도록 강제 설정 */
    .arrow {
      opacity: 1 !important;
      visibility: visible !important;
      display: block !important;
      position: fixed !important;
      top: 50% !important;
      transform: translateY(-50%) !important;
      z-index: 10000 !important;
      background: rgba(0, 0, 0, 0.2) !important;
      color: white !important;
      border: none !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
    }
    
    .arrow:hover {
      opacity: 1 !important;
      background: rgba(0, 0, 0, 0.4) !important;
    }
    
    .arrow.left, .arrow.right {
      opacity: 1 !important;
      visibility: visible !important;
      display: block !important;
    }
    
    /* 4zone.css의 hover 규칙을 무시하고 항상 표시 */
    .arrow:not(:hover):not(:focus):not(:active) {
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* slide-container hover와 관계없이 항상 표시 */
    .slide-container .arrow,
    .slide-container:hover .arrow {
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* 더 구체적인 선택자로 화살표 버튼 강제 표시 */
    button.arrow.left,
    button.arrow.right,
    .arrow.left,
    .arrow.right {
      opacity: 1 !important;
      visibility: visible !important;
      display: block !important;
      pointer-events: auto !important;
      z-index: 10000 !important;
    }
    
    /* 모든 화살표 관련 요소 강제 표시 */
    [class*="arrow"] {
      opacity: 1 !important;
      visibility: visible !important;
      display: block !important;
    }
    
    /* 4zoneApp.js에서 생성되는 네비게이션 버튼들을 항상 보이도록 */
    .nav-btn {
      opacity: 1 !important;
      visibility: visible !important;
      display: block !important;
    }
    
    .nav-btn:hover {
      opacity: 1 !important;
    }
    
    /* 모든 네비게이션 관련 버튼을 보이도록 */
    [class*="nav"], [id*="nav"] {
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* 페이지 인디케이터 스타일 */
    #page-indicator {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: auto !important;
      transition: opacity 0.5s ease !important;
      background: transparent !important;
      background-color: transparent !important;
    }
    
    #page-indicator.hidden {
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    /* 페이지 인디케이터 점들 */
    #page-indicator .page-dot {
      background-color: rgba(0, 0, 0, 0.6) !important;
      border: none !important;
      width: 8px !important;
      height: 8px !important;
      border-radius: 50% !important;
      margin: 0 4px !important;
      transition: all 0.3s ease !important;
    }
    
    #page-indicator .page-dot.active {
      background-color: rgba(0, 0, 0, 0.9) !important;
      border: none !important;
      transform: scale(1.2) !important;
    }
    
    /* 페이지 인디케이터 내의 모든 원형 요소 */
    #page-indicator > div {
      background-color: rgba(0, 0, 0, 0.6) !important;
      border: none !important;
      width: 8px !important;
      height: 8px !important;
      border-radius: 50% !important;
      margin: 0 4px !important;
      transition: all 0.3s ease !important;
    }
    
    /* 활성화된 페이지 인디케이터 점 */
    #page-indicator > div.active {
      background-color: rgba(0, 0, 0, 0.9) !important;
      border: none !important;
      transform: scale(1.2) !important;
    }
    
    /* ===== 반응형 CSS ===== */
    
    /* 가로모드 (landscape) 최적화 */
    @media screen and (orientation: landscape) {
      /* 가로모드에서 전체 높이 조정 */
      html, body {
        height: 100vh;
        height: -webkit-fill-available;
      }
      
      /* 슬라이드 컨테이너 가로모드 최적화 */
      .slide-container, .slide {
        height: 100vh;
        height: -webkit-fill-available;
        max-height: 100vh;
        max-height: -webkit-fill-available;
      }
      
      /* PDF2 이미지 가로모드 높이 통일 */
      .slide-bg[src*="pdf2"] {
        height: auto !important;
        max-height: 100vh !important;
        width: auto !important;
        max-width: 100% !important;
      }
      
      .slide[style*="pdf2"] .slide-img-wrapper {
        max-height: 100vh !important;
        max-width: 100% !important;
      }
      
      /* 텍스트 존 가로모드 크기 조정 */
      .text-zone p {
        font-size: 2.5vh !important;
        line-height: 1.2 !important;
      }
      
      /* 화살표 버튼 가로모드 크기 조정 */
      .arrow {
        width: 50px !important;
        height: 50px !important;
        font-size: 18px !important;
      }
      
      /* 페이지 인디케이터 가로모드 위치 조정 */
      #page-indicator {
        bottom: 8px !important;
        gap: 6px !important;
      }
      
      #page-indicator > div {
        width: 7px !important;
        height: 7px !important;
      }
    }
    
    /* 모바일: ~768px */
    @media (max-width: 768px) {
      /* 화살표 버튼 크기 및 위치 조정 */
      .arrow {
        width: 50px !important;
        height: 50px !important;
        font-size: 20px !important;
        border-radius: 25px !important;
        left: 10px !important;
        right: auto !important;
      }
      
      .arrow.left {
        left: 10px !important;
        right: auto !important;
      }
      
      .arrow.right {
        right: 10px !important;
        left: auto !important;
      }
      
      /* 페이지 인디케이터 크기 조정 */
      #page-indicator {
        bottom: 15px !important;
        gap: 6px !important;
      }
      
      #page-indicator > div {
        width: 8px !important;
        height: 8px !important;
      }
      
      /* 터치 이벤트 개선 */
      .arrow {
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: transparent !important;
      }
      
      /* 모바일에서 버튼 터치 영역 확대 */
      .arrow::before {
        content: '';
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        z-index: -1;
      }
      
      /* 모바일 가로모드 추가 최적화 */
      @media screen and (orientation: landscape) {
        .text-zone p {
          font-size: 2vh !important;
          line-height: 1.1 !important;
        }
        
        .arrow {
          width: 45px !important;
          height: 45px !important;
          font-size: 16px !important;
        }
        
        #page-indicator {
          bottom: 5px !important;
        }
        
        #page-indicator > div {
          width: 6px !important;
          height: 6px !important;
        }
      }
    }
    
    /* 태블릿: 768px~1024px */
    @media (min-width: 769px) and (max-width: 1024px) {
      /* 화살표 버튼 크기 및 위치 조정 */
      .arrow {
        width: 55px !important;
        height: 55px !important;
        font-size: 22px !important;
        border-radius: 27.5px !important;
      }
      
      .arrow.left {
        left: 15px !important;
        right: auto !important;
      }
      
      .arrow.right {
        right: 15px !important;
        left: auto !important;
      }
      
      /* 페이지 인디케이터 크기 조정 */
      #page-indicator {
        bottom: 12px !important;
        gap: 7px !important;
      }
      
      #page-indicator > div {
        width: 9px !important;
        height: 9px !important;
      }
      
      /* 태블릿 가로모드 추가 최적화 */
      @media screen and (orientation: landscape) {
        .text-zone p {
          font-size: 2.2vh !important;
          line-height: 1.15 !important;
        }
        
        .arrow {
          width: 50px !important;
          height: 50px !important;
          font-size: 20px !important;
        }
        
        #page-indicator {
          bottom: 8px !important;
        }
        
        #page-indicator > div {
          width: 8px !important;
          height: 8px !important;
        }
      }
    }
    
    /* 데스크톱: 1024px+ */
    @media (min-width: 1025px) {
      /* 화살표 버튼 크기 및 위치 조정 */
      .arrow {
        width: 60px !important;
        height: 60px !important;
        font-size: 24px !important;
        border-radius: 30px !important;
      }
      
      .arrow.left {
        left: 20px !important;
        right: auto !important;
      }
      
      .arrow.right {
        right: 20px !important;
        left: auto !important;
      }
      
      /* 페이지 인디케이터 크기 조정 */
      #page-indicator {
        bottom: 10px !important;
        gap: 8px !important;
      }
      
      #page-indicator > div {
        width: 10px !important;
        height: 10px !important;
      }
      
      /* 데스크톱 가로모드 추가 최적화 */
      @media screen and (orientation: landscape) {
        .text-zone p {
          font-size: 2.8vh !important;
          line-height: 1.2 !important;
        }
        
        .arrow {
          width: 55px !important;
          height: 55px !important;
          font-size: 22px !important;
        }
        
        #page-indicator {
          bottom: 10px !important;
        }
        
        #page-indicator > div {
          width: 9px !important;
          height: 9px !important;
        }
      }
    }
    
    /* 모바일 터치 이벤트 개선 */
    @media (max-width: 768px) {
      /* 터치 이벤트 최적화 */
      .arrow {
        -webkit-user-select: none !important;
        -moz-user-select: none !important;
        -ms-user-select: none !important;
        user-select: none !important;
        -webkit-touch-callout: none !important;
        -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
      }
      
      /* 모바일에서 버튼 클릭/터치 영역 확대 */
      .arrow.left,
      .arrow.right {
        min-width: 60px !important;
        min-height: 60px !important;
        padding: 0 !important;
        margin: 0 !important;
      }
    }
    
    /* PDF2 슬라이드별 배경색 강제 적용 */
    .slide-container .slide:nth-child(1) { background-color: #112836 !important; }
    .slide-container .slide:nth-child(2) { background-color: #061722 !important; }
    .slide-container .slide:nth-child(3) { background-color: #112836 !important; }
    .slide-container .slide:nth-child(4) { background-color: #1c3645 !important; }
    .slide-container .slide:nth-child(5) { background-color: #112836 !important; }
    .slide-container .slide:nth-child(6) { background-color: #1c3645 !important; }
    .slide-container .slide:nth-child(7) { background-color: #061722 !important; }
    .slide-container .slide:nth-child(8) { background-color: #1c3645 !important; }
    .slide-container .slide:nth-child(9) { background-color: #1c3645 !important; }
    .slide-container .slide:nth-child(10) { background-color: #112836 !important; }
    

  </style>
</head>
<body>
  <!-- 전체화면 모달 -->
  <div id="fullscreen-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:100000; align-items:center; justify-content:center;">
    <div style="background:#fff; padding:3em; border-radius:20px; text-align:center; max-width:500px; margin:2em;">
      <h2 style="margin:0 0 1em 0; color:#222; font-size:1.8em;">Continue the story in fullscreen.</h2>
      <button id="fullscreen-modal-btn" style="background:#222; color:#fff; border:none; padding:1em 2em; font-size:1.2em; border-radius:10px; cursor:pointer; transition:background 0.2s;" onmouseover="this.style.background='#444'" onmouseout="this.style.background='#222'">CHECK</button>
    </div>
    </div>
  
  <!-- 페이지 인디케이터 -->
  <div id="page-indicator" style="position:fixed; bottom:10px; left:50%; transform:translateX(-50%); z-index:1000; display:flex; gap:8px; align-items:center; opacity:1; transition:opacity 0.3s ease; background:transparent; background-color:transparent;">
    <!-- 동그라미들이 여기에 동적으로 생성됩니다 -->
  </div>
  
  <div id="tabbar-container">
    <button id="tabbar-x-btn" style="position:absolute; right:18px; top:12px; font-weight:bold; font-size:2rem; background:transparent; border:none; box-shadow:none; color:#222; z-index:10000; width:auto; height:auto;">×</button>
    <div id="tabbar" style="margin-top:37px;">
      <button class="tab" data-label="National Geographic">National Geographic</button>
      <button class="tab" data-label="Discovery">Discovery</button>
      <button class="tab" data-label="TED">TED</button>
      <button class="tab" data-label="BBC Earth">BBC Earth</button>
    </div>
    <div id="searchbox">
      <input type="text" id="searchInput" placeholder="검색어를 입력하세요" />
      <button id="searchBtn">Search</button>
    </div>
  </div>
  <div id="tabbar-modal-overlay"></div>
  <div id="app"></div>
  <script src="https://www.youtube.com/iframe_api"></script>
  
  <!-- 슬라이드 데이터 -->
  <script>
  const slideTemplates = [
    {
      bg: '../assets/img/pdf/pdf2/1.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/2.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/3.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/4.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/5.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/6.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/7.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/8.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/9.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    },
    {
      bg: '../assets/img/pdf/pdf2/10.jpg',
      zones: {
        1: { text: '', keywords: [] },
        2: { text: '', keywords: [] },
        3: { text: '', keywords: [] },
        4: { text: '', keywords: [] }
      }
    }
  ];
  </script>
  

  
  <!-- 슬라이드 기능 스크립트 -->
  <script>
    // 슬라이드 관련 변수
    let current = 0;
    let textAnimated = Array(slideTemplates.length).fill(false);
    
    // 디버깅을 위한 슬라이드 인덱스 추적
    console.log('Total slides:', slideTemplates.length);
    console.log('Slide templates:', slideTemplates.map((slide, index) => `${index}: ${slide.bg}`));
    
    // 슬라이드 렌더링 함수
    function renderSlide(idx) {
      console.log('=== RENDER SLIDE DEBUG ===');
      console.log('Rendering slide index:', idx);
      console.log('Slide template at index:', slideTemplates[idx]);
      console.log('Image path:', slideTemplates[idx].bg);
      console.log('==========================');
      
      const slide = slideTemplates[idx];
      const app = document.getElementById('app');
      app.innerHTML = '';

      const container = document.createElement('div');
      container.className = 'slide-container';

      // 왼쪽 화살표
      const leftArrow = document.createElement('button');
      leftArrow.className = 'arrow left';
      leftArrow.innerHTML = '&#60;';
      leftArrow.tabIndex = -1;
      leftArrow.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        prevSlide();
      });
      leftArrow.addEventListener('touchstart', (e) => {
        e.preventDefault();
        e.stopPropagation();
        prevSlide();
      });
      container.appendChild(leftArrow);

      // 이미지 래퍼
      const imgWrapper = document.createElement('div');
      imgWrapper.className = 'slide-img-wrapper';

      // 이미지
      const img = document.createElement('img');
      img.className = 'slide-bg';
      img.src = slide.bg;
      img.alt = 'slide';
      imgWrapper.appendChild(img);

      // 텍스트 존 생성
      Object.entries(slide.zones).forEach(([zoneNum, zoneData]) => {
        if (zoneData.text) {
          const textZone = document.createElement('div');
          textZone.className = `text-zone zone-${zoneNum}`;
          const lines = zoneData.text.split(/<br\s*\/?>|\n/);
          lines.forEach(line => {
            if (line.trim() === '') return;
            const paragraph = document.createElement('p');
            paragraph.innerHTML = line;
            textZone.appendChild(paragraph);
          });
          imgWrapper.appendChild(textZone);
        }
      });

      container.appendChild(imgWrapper);

      // 오른쪽 화살표
      const rightArrow = document.createElement('button');
      rightArrow.className = 'arrow right';
      rightArrow.innerHTML = '&#62;';
      rightArrow.tabIndex = -1;
      rightArrow.addEventListener('click', (e) => {
        console.log('=== RIGHT ARROW CLICK ===');
        console.log('Event target:', e.target);
        console.log('Current before click:', current);
        e.preventDefault();
        e.stopPropagation();
        nextSlide();
      });
      rightArrow.addEventListener('touchstart', (e) => {
        console.log('=== RIGHT ARROW TOUCH ===');
        console.log('Event target:', e.target);
        console.log('Current before touch:', current);
        e.preventDefault();
        e.stopPropagation();
        nextSlide();
      });
      container.appendChild(rightArrow);

      app.appendChild(container);
      
      // 드래그 이벤트 추가
      addDragEvents(container, leftArrow, rightArrow);
    }
    
    // 다음 슬라이드
    function nextSlide() {
      console.log('=== NEXT SLIDE DEBUG ===');
      console.log('Current before next:', current);
      console.log('Total slides:', slideTemplates.length);
      console.log('Current slide image:', slideTemplates[current].bg);
      console.log('Stack trace:', new Error().stack);
      
      let next = (current + 1) % slideTemplates.length;
      console.log('Calculated next index:', next);
      
      current = next;
      console.log('Current after update:', current);
      console.log('Next slide image:', slideTemplates[current].bg);
      console.log('========================');
      
      renderSlide(current);
      updatePageIndicator();
    }
    
    // 이전 슬라이드
    function prevSlide() {
      console.log('Current before prev:', current);
      let prev = (current - 1 + slideTemplates.length) % slideTemplates.length;
      current = prev;
      console.log('Prev slide index:', current, 'Image:', slideTemplates[current].bg);
      renderSlide(current);
      updatePageIndicator();
    }
    
    // 드래그 이벤트
    function addDragEvents(container, leftArrow, rightArrow) {
      let startX = null;
      let dragging = false;
      
      // 마우스 이벤트
      container.addEventListener('mousedown', e => { 
        // 화살표 버튼 클릭 시 드래그 시작하지 않음
        if (e.target.closest('.arrow')) return;
        e.preventDefault(); 
        startX = e.clientX; 
        dragging = true; 
      });
      container.addEventListener('mousemove', e => { 
        if (!dragging) return; 
        e.preventDefault(); 
      });
      container.addEventListener('mouseup', e => {
        if (!dragging) return;
        e.preventDefault();
        const diff = e.clientX - startX;
        if (diff > 60) { 
          prevSlide();
        }
        else if (diff < -60) { 
          nextSlide();
        }
        dragging = false;
        startX = null;
      });
      
      // 터치 이벤트
      container.addEventListener('touchstart', e => {
        // 화살표 버튼 터치 시 드래그 시작하지 않음
        if (e.target.closest('.arrow')) return;
        e.preventDefault();
        startX = e.touches[0].clientX;
        dragging = true;
      }, { passive: false });
      container.addEventListener('touchmove', e => {
        if (!dragging) return;
        e.preventDefault();
      }, { passive: false });
      container.addEventListener('touchend', e => {
        if (!dragging) return;
        e.preventDefault();
        const endX = e.changedTouches[0].clientX;
        const diff = endX - startX;
        if (diff > 60) { 
          prevSlide();
        }
        else if (diff < -60) { 
          nextSlide();
        }
        dragging = false;
        startX = null;
      }, { passive: false });
    }
    
    // 페이지 인디케이터 업데이트
    function updatePageIndicator() {
      const indicator = document.getElementById('page-indicator');
      if (!indicator) return;
      
      indicator.innerHTML = '';
      
      for (let i = 0; i < slideTemplates.length; i++) {
        const dot = document.createElement('div');
        dot.className = 'page-dot';
        if (i === current) {
          dot.classList.add('active');
        }
        dot.addEventListener('click', () => {
          current = i;
          renderSlide(current);
          updatePageIndicator();
        });
        indicator.appendChild(dot);
      }
      
      // 슬라이드 변경 시 페이지 인디케이터 표시 후 자동 숨김
      showPageIndicatorTemporarily();
    }
    
    // 전역 함수로 노출
    window.nextSlide = nextSlide;
    window.prevSlide = prevSlide;
    window.goToPage = function(pageIndex) {
      current = pageIndex;
      renderSlide(current);
      updatePageIndicator();
    };
    window.getCurrentPageIndex = function() {
      return current;
    };
    
    // 페이지 인디케이터 자동 숨김 기능
    let hideTimeout = null;
    
    // 페이지 인디케이터 임시 표시 함수
    function showPageIndicatorTemporarily() {
      const pageIndicator = document.getElementById('page-indicator');
      if (pageIndicator) {
        // 기존 타이머가 있다면 제거
        if (hideTimeout) {
          clearTimeout(hideTimeout);
        }
        
        // 페이지 인디케이터 표시
        pageIndicator.classList.remove('hidden');
        
        // 2초 후 자동 숨김
        hideTimeout = setTimeout(function() {
          pageIndicator.classList.add('hidden');
        }, 2000);
      }
    }
    
    function setupPageIndicatorAutoHide() {
      const pageIndicator = document.getElementById('page-indicator');
      if (pageIndicator) {
        // 기존 타이머가 있다면 제거
        if (hideTimeout) {
          clearTimeout(hideTimeout);
        }
        
        // 2초 후 자동 숨김
        hideTimeout = setTimeout(function() {
          pageIndicator.classList.add('hidden');
        }, 2000);
        
        // 마우스 움직임이나 클릭 시 다시 표시
        function showIndicator() {
          pageIndicator.classList.remove('hidden');
          
          // 기존 타이머가 있다면 제거
          if (hideTimeout) {
            clearTimeout(hideTimeout);
          }
          
          // 새로운 타이머 설정
          hideTimeout = setTimeout(function() {
            pageIndicator.classList.add('hidden');
          }, 2000);
        }
        
        // 기존 이벤트 리스너 제거 (중복 방지)
        document.removeEventListener('mousemove', showIndicator);
        document.removeEventListener('click', showIndicator);
        document.removeEventListener('touchstart', showIndicator);
        
        // 마우스 움직임 감지
        document.addEventListener('mousemove', showIndicator);
        document.addEventListener('click', showIndicator);
        document.addEventListener('touchstart', showIndicator);
        
        // 화살표 버튼 클릭 시에도 표시
        const arrows = document.querySelectorAll('.arrow');
        arrows.forEach(arrow => {
          arrow.removeEventListener('click', showIndicator);
          arrow.removeEventListener('touchstart', showIndicator);
          arrow.addEventListener('click', showIndicator);
          arrow.addEventListener('touchstart', showIndicator);
        });
      }
    }
    
    // 초기화
    document.addEventListener('DOMContentLoaded', function() {
      renderSlide(0);
      updatePageIndicator();
      setTimeout(setupPageIndicatorAutoHide, 500);
    });
  </script>
  

</body>
</html> 